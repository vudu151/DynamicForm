<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlantUML URL Generator - DynamicForm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .content {
            padding: 30px;
        }
        
        .diagram-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .diagram-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
            background: #f9f9f9;
        }
        
        .diagram-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }
        
        .diagram-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .diagram-card p {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 0.9em;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }
        
        .btn-secondary {
            background: #28a745;
        }
        
        .btn-secondary:hover {
            background: #218838;
        }
        
        .editor-section {
            margin-top: 30px;
            border-top: 2px solid #e0e0e0;
            padding-top: 30px;
        }
        
        .editor-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }
        
        textarea {
            width: 100%;
            min-height: 400px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .info-box strong {
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå≥ PlantUML URL Generator</h1>
            <p>DynamicForm - UML Activity Diagrams</p>
        </div>
        
        <div class="content">
            <div class="info-box">
                <strong>H∆∞·ªõng d·∫´n:</strong> Ch·ªçn m·ªôt diagram t·ª´ danh s√°ch b√™n d∆∞·ªõi, sau ƒë√≥ click "M·ªü PlantUML Web" ƒë·ªÉ xem s∆° ƒë·ªì tr√™n tr√¨nh duy·ªát. 
                Ho·∫∑c copy code PlantUML v√† paste v√†o editor b√™n d∆∞·ªõi ƒë·ªÉ ch·ªânh s·ª≠a.
            </div>
            
            <div class="diagram-list" id="diagramList">
                <!-- Diagrams will be loaded here -->
            </div>
            
            <div class="editor-section">
                <h2>üìù PlantUML Editor</h2>
                <p style="color: #666; margin-bottom: 15px;">Paste ho·∫∑c ch·ªânh s·ª≠a code PlantUML ·ªü ƒë√¢y:</p>
                <textarea id="plantumlCode" placeholder="@startuml
title Your Diagram

start
:Your activity here;
stop

@enduml"></textarea>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="openPlantUML()">üöÄ M·ªü PlantUML Web</button>
                    <button class="btn" onclick="copyToClipboard()">üìã Copy Code</button>
                    <button class="btn" onclick="clearEditor()">üóëÔ∏è X√≥a</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Danh s√°ch c√°c diagram
        const diagrams = [
            {
                id: '01',
                title: 'T·∫°o v√† Thi·∫øt k·∫ø Form',
                description: 'Quy tr√¨nh Admin t·∫°o form m·ªõi, thi·∫øt k·∫ø metadata v√† k√≠ch ho·∫°t version',
                file: '01-Tao-Thiet-Ke-Form.puml'
            },
            {
                id: '02',
                title: 'ƒêi·ªÅn v√† L∆∞u D·ªØ li·ªáu',
                description: 'Quy tr√¨nh User ƒëi·ªÅn form, validate v√† l∆∞u d·ªØ li·ªáu v√†o database',
                file: '02-Dien-Luu-Du-Lieu.puml'
            },
            {
                id: '03',
                title: 'Xem v√† S·ª≠a D·ªØ li·ªáu',
                description: 'Quy tr√¨nh xem v√† c·∫≠p nh·∫≠t d·ªØ li·ªáu form ƒë√£ l∆∞u',
                file: '03-Xem-Sua-Du-Lieu.puml'
            },
            {
                id: '04',
                title: 'T·∫°o Version m·ªõi',
                description: 'Quy tr√¨nh t·ª± ƒë·ªông t·∫°o version khi form ƒë√£ t·ªìn t·∫°i',
                file: '04-Tao-Version-Moi.puml'
            },
            {
                id: '05',
                title: 'Validate D·ªØ li·ªáu',
                description: 'Quy tr√¨nh chi ti·∫øt v·ªÅ validation engine',
                file: '05-Validate-Du-Lieu.puml'
            },
            {
                id: '06',
                title: 'T·ªïng h·ª£p - Lu·ªìng h·ªá th·ªëng',
                description: 'T·ªïng quan lu·ªìng s·ª≠ d·ª•ng h·ªá th·ªëng t·ª´ c√°c actor',
                file: '06-Tong-Hop.puml'
            }
        ];
        
        // Load diagrams v√†o danh s√°ch
        function loadDiagrams() {
            const list = document.getElementById('diagramList');
            diagrams.forEach(diagram => {
                const card = document.createElement('div');
                card.className = 'diagram-card';
                card.innerHTML = `
                    <h3>${diagram.id}. ${diagram.title}</h3>
                    <p>${diagram.description}</p>
                    <button class="btn" onclick="loadDiagram('${diagram.file}')">üìÑ Load v√†o Editor</button>
                    <button class="btn btn-secondary" onclick="openDiagram('${diagram.file}')">üöÄ M·ªü PlantUML Web</button>
                `;
                list.appendChild(card);
            });
        }
        
        // Load diagram v√†o editor
        async function loadDiagram(filename) {
            try {
                const response = await fetch(filename);
                if (!response.ok) {
                    // N·∫øu kh√¥ng load ƒë∆∞·ª£c file, th·ª≠ load t·ª´ n·ªôi dung ƒë√£ bi·∫øt
                    console.log('Cannot load file, using fallback');
                    return;
                }
                const code = await response.text();
                document.getElementById('plantumlCode').value = code;
                document.getElementById('plantumlCode').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                alert('Kh√¥ng th·ªÉ load file. Vui l√≤ng m·ªü file .puml tr·ª±c ti·∫øp t·ª´ th∆∞ m·ª•c diagrams/');
            }
        }
        
        // M·ªü diagram tr√™n PlantUML web
        async function openDiagram(filename) {
            try {
                const response = await fetch(filename);
                if (!response.ok) {
                    alert('Kh√¥ng th·ªÉ load file. Vui l√≤ng copy code t·ª´ file .puml v√† paste v√†o editor.');
                    return;
                }
                const code = await response.text();
                openPlantUMLWithCode(code);
            } catch (error) {
                alert('Kh√¥ng th·ªÉ load file. Vui l√≤ng copy code t·ª´ file .puml v√† paste v√†o editor.');
            }
        }
        
        // Encode PlantUML code th√†nh URL
        function encodePlantUML(code) {
            // PlantUML s·ª≠ d·ª•ng encoding ƒë·∫∑c bi·ªát
            // S·ª≠ d·ª•ng deflate compression v√† base64 encoding
            // ƒê∆°n gi·∫£n h√≥a: s·ª≠ d·ª•ng encodeURIComponent
            return encodeURIComponent(code);
        }
        
        // M·ªü PlantUML web v·ªõi code
        function openPlantUMLWithCode(code) {
            // PlantUML web server s·ª≠ d·ª•ng format: http://www.plantuml.com/plantuml/uml/{encoded}
            // Encoding: deflate + base64
            // T·∫°m th·ªùi s·ª≠ d·ª•ng c√°ch ƒë∆°n gi·∫£n: copy code v√† m·ªü trang web
            const url = 'http://www.plantuml.com/plantuml/uml/';
            window.open(url, '_blank');
            
            // L∆∞u code v√†o localStorage ƒë·ªÉ user c√≥ th·ªÉ paste
            localStorage.setItem('plantuml_code', code);
            alert('ƒê√£ m·ªü PlantUML Web Server.\n\nVui l√≤ng:\n1. Copy code t·ª´ editor b√™n d∆∞·ªõi\n2. Paste v√†o √¥ text tr√™n trang PlantUML\n3. Click "Submit" ƒë·ªÉ xem s∆° ƒë·ªì');
        }
        
        // M·ªü PlantUML web v·ªõi code t·ª´ editor
        function openPlantUML() {
            const code = document.getElementById('plantumlCode').value;
            if (!code.trim()) {
                alert('Vui l√≤ng nh·∫≠p code PlantUML v√†o editor tr∆∞·ªõc!');
                return;
            }
            openPlantUMLWithCode(code);
        }
        
        // Copy code v√†o clipboard
        function copyToClipboard() {
            const code = document.getElementById('plantumlCode').value;
            if (!code.trim()) {
                alert('Kh√¥ng c√≥ code ƒë·ªÉ copy!');
                return;
            }
            
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ ƒê√£ copy code v√†o clipboard!\n\nB√¢y gi·ªù b·∫°n c√≥ th·ªÉ paste v√†o PlantUML Web Server.');
            }).catch(err => {
                // Fallback cho tr√¨nh duy·ªát c≈©
                const textarea = document.createElement('textarea');
                textarea.value = code;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ ƒê√£ copy code v√†o clipboard!');
            });
        }
        
        // X√≥a editor
        function clearEditor() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô code trong editor?')) {
                document.getElementById('plantumlCode').value = '';
            }
        }
        
        // Load diagrams khi trang load
        window.onload = function() {
            loadDiagrams();
            
            // Ki·ªÉm tra xem c√≥ code ƒë√£ l∆∞u kh√¥ng
            const savedCode = localStorage.getItem('plantuml_code');
            if (savedCode) {
                document.getElementById('plantumlCode').value = savedCode;
                localStorage.removeItem('plantuml_code');
            }
        };
    </script>
</body>
</html>
